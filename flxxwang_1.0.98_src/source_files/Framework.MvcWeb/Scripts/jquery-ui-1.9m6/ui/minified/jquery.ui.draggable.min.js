/*
 * jQuery UI Draggable 1.9m6
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Draggables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(c){c.widget("ui.draggable",c.ui.mouse,{version:"1.9m6",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper==
"original"&&!/^(?:r|a|f)/.test(this.element.css("position")))this.element[0].style.position="relative";this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this}},_mouseCapture:function(a){var d=
this.options;if(this.helper||d.disabled||c(a.target).is(".ui-resizable-handle"))return false;this.handle=this._getHandle(a);if(!this.handle)return false;c(d.iframeFix===true?"iframe":d.iframeFix).each(function(){c('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(c(this).offset()).appendTo("body")});return true},_mouseStart:function(a){var d=this.options;this.helper=
this._createHelper(a);this._cacheHelperProportions();if(c.ui.ddmanager)c.ui.ddmanager.current=this;this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};c.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});
this.originalPosition=this.position=this._generatePosition(a);this.originalPageX=a.pageX;this.originalPageY=a.pageY;d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt);d.containment&&this._setContainment();if(this._trigger("start",a)===false){this._clear();return false}this._cacheHelperProportions();c.ui.ddmanager&&!d.dropBehaviour&&c.ui.ddmanager.prepareOffsets(this,a);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(a,true);c.ui.ddmanager&&c.ui.ddmanager.dragStart(this,a);return true},
_mouseDrag:function(a,d){this.position=this._generatePosition(a);this.positionAbs=this._convertPositionTo("absolute");if(!d){var b=this._uiHash();if(this._trigger("drag",a,b)===false){this._mouseUp({});return false}this.position=b.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";c.ui.ddmanager&&c.ui.ddmanager.drag(this,a);return false},_mouseStop:function(a){var d=
false;if(c.ui.ddmanager&&!this.options.dropBehaviour)d=c.ui.ddmanager.drop(this,a);if(this.dropped){d=this.dropped;this.dropped=false}if(!this.element[0]||!this.element[0].parentNode)return false;if(this.options.revert=="invalid"&&!d||this.options.revert=="valid"&&d||this.options.revert===true||c.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)){var b=this;c(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){b._trigger("stop",a)!==
false&&b._clear()})}else this._trigger("stop",a)!==false&&this._clear();return false},_mouseUp:function(a){this.options.iframeFix===true&&c("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});c.ui.ddmanager&&c.ui.ddmanager.dragStop(this,a);return c.ui.mouse.prototype._mouseUp.call(this,a)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(a){var d=!this.options.handle||!c(this.options.handle,this.element).length?
true:false;c(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==a.target)d=true});return d},_createHelper:function(a){var d=this.options;a=c.isFunction(d.helper)?c(d.helper.apply(this.element[0],[a])):d.helper=="clone"?this.element.clone().removeAttr("id"):this.element;a.parents("body").length||a.appendTo(d.appendTo=="parent"?this.element[0].parentNode:d.appendTo);a[0]!=this.element[0]&&!/(fixed|absolute)/.test(a.css("position"))&&a.css("position","absolute");return a},
_adjustOffsetFromHelper:function(a){if(typeof a=="string")a=a.split(" ");if(c.isArray(a))a={left:+a[0],top:+a[1]||0};if("left"in a)this.offset.click.left=a.left+this.margins.left;if("right"in a)this.offset.click.left=this.helperProportions.width-a.right+this.margins.left;if("top"in a)this.offset.click.top=a.top+this.margins.top;if("bottom"in a)this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var a=
this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&c.contains(this.scrollParent[0],this.offsetParent[0])){a.left+=this.scrollParent.scrollLeft();a.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&c.browser.msie)a={top:0,left:0};return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),
10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),
10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a=this.options;if(a.containment=="parent")a.containment=this.helper[0].parentNode;if(a.containment=="document"||a.containment=="window")this.containment=[a.containment=="document"?0:c(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a.containment=="document"?0:c(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,
(a.containment=="document"?0:c(window).scrollLeft())+c(a.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a.containment=="document"?0:c(window).scrollTop())+(c(a.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(a.containment)&&a.containment.constructor!=Array){a=c(a.containment);var d=a[0];if(d){a.offset();var b=c(d).css("overflow")!=
"hidden";this.containment=[(parseInt(c(d).css("borderLeftWidth"),10)||0)+(parseInt(c(d).css("paddingLeft"),10)||0),(parseInt(c(d).css("borderTopWidth"),10)||0)+(parseInt(c(d).css("paddingTop"),10)||0),(b?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c(d).css("borderLeftWidth"),10)||0)-(parseInt(c(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c(d).css("borderTopWidth"),
10)||0)-(parseInt(c(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=a}}else if(a.containment.constructor==Array)this.containment=a.containment},_convertPositionTo:function(a,d){if(!d)d=this.position;var b=a=="absolute"?1:-1,f=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&c.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(f[0].tagName);return{top:d.top+
this.offset.relative.top*b+this.offset.parent.top*b-(c.browser.safari&&c.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:f.scrollTop())*b),left:d.left+this.offset.relative.left*b+this.offset.parent.left*b-(c.browser.safari&&c.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:f.scrollLeft())*b)}},_generatePosition:function(a){var d=this.options,b=this.cssPosition=="absolute"&&
!(this.scrollParent[0]!=document&&c.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(b[0].tagName),e=a.pageX,h=a.pageY;if(this.originalPosition){var g;if(this.containment){if(this.relative_container){g=this.relative_container.offset();g=[this.containment[0]+g.left,this.containment[1]+g.top,this.containment[2]+g.left,this.containment[3]+g.top]}else g=this.containment;if(a.pageX-this.offset.click.left<g[0])e=g[0]+this.offset.click.left;if(a.pageY-
this.offset.click.top<g[1])h=g[1]+this.offset.click.top;if(a.pageX-this.offset.click.left>g[2])e=g[2]+this.offset.click.left;if(a.pageY-this.offset.click.top>g[3])h=g[3]+this.offset.click.top}if(d.grid){h=d.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/d.grid[1])*d.grid[1]:this.originalPageY;h=g?!(h-this.offset.click.top<g[1]||h-this.offset.click.top>g[3])?h:!(h-this.offset.click.top<g[1])?h-d.grid[1]:h+d.grid[1]:h;e=d.grid[0]?this.originalPageX+Math.round((e-this.originalPageX)/d.grid[0])*
d.grid[0]:this.originalPageX;e=g?!(e-this.offset.click.left<g[0]||e-this.offset.click.left>g[2])?e:!(e-this.offset.click.left<g[0])?e-d.grid[0]:e+d.grid[0]:e}}return{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(c.browser.safari&&c.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:b.scrollTop()),left:e-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(c.browser.safari&&c.browser.version<
526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():f?0:b.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=false},_trigger:function(a,d,b){b=b||this._uiHash();c.ui.plugin.call(this,a,[d,b]);if(a=="drag")this.positionAbs=this._convertPositionTo("absolute");return c.Widget.prototype._trigger.call(this,a,d,
b)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});c.ui.plugin.add("draggable","connectToSortable",{start:function(a,d){var b=c(this).data("draggable"),f=b.options,e=c.extend({},d,{item:b.element});b.sortables=[];c(f.connectToSortable).each(function(){var h=c.data(this,"sortable");if(h&&!h.options.disabled){b.sortables.push({instance:h,shouldRevert:h.options.revert});h.refreshPositions();h._trigger("activate",
a,e)}})},stop:function(a,d){var b=c(this).data("draggable"),f=c.extend({},d,{item:b.element});c.each(b.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;b.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert)this.instance.options.revert=true;this.instance._mouseStop(a);this.instance.options.helper=this.instance.options._helper;b.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})}else{this.instance.cancelHelperRemoval=
false;this.instance._trigger("deactivate",a,f)}})},drag:function(a,d){var b=c(this).data("draggable"),f=this;c.each(b.sortables,function(){this.instance.positionAbs=b.positionAbs;this.instance.helperProportions=b.helperProportions;this.instance.offset.click=b.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=c(f).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",true);
this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return d.helper[0]};a.target=this.instance.currentItem[0];this.instance._mouseCapture(a,true);this.instance._mouseStart(a,true,true);this.instance.offset.click.top=b.offset.click.top;this.instance.offset.click.left=b.offset.click.left;this.instance.offset.parent.left-=b.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=b.offset.parent.top-this.instance.offset.parent.top;
b._trigger("toSortable",a);b.dropped=this.instance.element;b.currentItem=b.element;this.instance.fromOutside=b}this.instance.currentItem&&this.instance._mouseDrag(a)}else if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",a,this.instance._uiHash(this.instance));this.instance._mouseStop(a,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();this.instance.placeholder&&
this.instance.placeholder.remove();b._trigger("fromSortable",a);b.dropped=false}})}});c.ui.plugin.add("draggable","cursor",{start:function(){var a=c("body"),d=c(this).data("draggable").options;if(a.css("cursor"))d._cursor=a.css("cursor");a.css("cursor",d.cursor)},stop:function(){var a=c(this).data("draggable").options;a._cursor&&c("body").css("cursor",a._cursor)}});c.ui.plugin.add("draggable","opacity",{start:function(a,d){var b=c(d.helper),f=c(this).data("draggable").options;if(b.css("opacity"))f._opacity=
b.css("opacity");b.css("opacity",f.opacity)},stop:function(a,d){var b=c(this).data("draggable").options;b._opacity&&c(d.helper).css("opacity",b._opacity)}});c.ui.plugin.add("draggable","scroll",{start:function(){var a=c(this).data("draggable");if(a.scrollParent[0]!=document&&a.scrollParent[0].tagName!="HTML")a.overflowOffset=a.scrollParent.offset()},drag:function(a){var d=c(this).data("draggable"),b=d.options,f=false;if(d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"){if(!b.axis||b.axis!=
"x")if(d.overflowOffset.top+d.scrollParent[0].offsetHeight-a.pageY<b.scrollSensitivity)d.scrollParent[0].scrollTop=f=d.scrollParent[0].scrollTop+b.scrollSpeed;else if(a.pageY-d.overflowOffset.top<b.scrollSensitivity)d.scrollParent[0].scrollTop=f=d.scrollParent[0].scrollTop-b.scrollSpeed;if(!b.axis||b.axis!="y")if(d.overflowOffset.left+d.scrollParent[0].offsetWidth-a.pageX<b.scrollSensitivity)d.scrollParent[0].scrollLeft=f=d.scrollParent[0].scrollLeft+b.scrollSpeed;else if(a.pageX-d.overflowOffset.left<
b.scrollSensitivity)d.scrollParent[0].scrollLeft=f=d.scrollParent[0].scrollLeft-b.scrollSpeed}else{if(!b.axis||b.axis!="x")if(a.pageY-c(document).scrollTop()<b.scrollSensitivity)f=c(document).scrollTop(c(document).scrollTop()-b.scrollSpeed);else if(c(window).height()-(a.pageY-c(document).scrollTop())<b.scrollSensitivity)f=c(document).scrollTop(c(document).scrollTop()+b.scrollSpeed);if(!b.axis||b.axis!="y")if(a.pageX-c(document).scrollLeft()<b.scrollSensitivity)f=c(document).scrollLeft(c(document).scrollLeft()-
b.scrollSpeed);else if(c(window).width()-(a.pageX-c(document).scrollLeft())<b.scrollSensitivity)f=c(document).scrollLeft(c(document).scrollLeft()+b.scrollSpeed)}f!==false&&c.ui.ddmanager&&!b.dropBehaviour&&c.ui.ddmanager.prepareOffsets(d,a)}});c.ui.plugin.add("draggable","snap",{start:function(){var a=c(this).data("draggable"),d=a.options;a.snapElements=[];c(d.snap.constructor!=String?d.snap.items||":data(draggable)":d.snap).each(function(){var b=c(this),f=b.offset();this!=a.element[0]&&a.snapElements.push({item:this,
width:b.outerWidth(),height:b.outerHeight(),top:f.top,left:f.left})})},drag:function(a,d){for(var b=c(this).data("draggable"),f=b.options,e=f.snapTolerance,h=d.offset.left,g=h+b.helperProportions.width,n=d.offset.top,o=n+b.helperProportions.height,i=b.snapElements.length-1;i>=0;i--){var j=b.snapElements[i].left,l=j+b.snapElements[i].width,k=b.snapElements[i].top,m=k+b.snapElements[i].height;if(j-e<h&&h<l+e&&k-e<n&&n<m+e||j-e<h&&h<l+e&&k-e<o&&o<m+e||j-e<g&&g<l+e&&k-e<n&&n<m+e||j-e<g&&g<l+e&&k-e<o&&
o<m+e){if(f.snapMode!="inner"){var p=Math.abs(k-o)<=e,q=Math.abs(m-n)<=e,r=Math.abs(j-g)<=e,s=Math.abs(l-h)<=e;if(p)d.position.top=b._convertPositionTo("relative",{top:k-b.helperProportions.height,left:0}).top-b.margins.top;if(q)d.position.top=b._convertPositionTo("relative",{top:m,left:0}).top-b.margins.top;if(r)d.position.left=b._convertPositionTo("relative",{top:0,left:j-b.helperProportions.width}).left-b.margins.left;if(s)d.position.left=b._convertPositionTo("relative",{top:0,left:l}).left-b.margins.left}var t=
p||q||r||s;if(f.snapMode!="outer"){p=Math.abs(k-n)<=e;q=Math.abs(m-o)<=e;r=Math.abs(j-h)<=e;s=Math.abs(l-g)<=e;if(p)d.position.top=b._convertPositionTo("relative",{top:k,left:0}).top-b.margins.top;if(q)d.position.top=b._convertPositionTo("relative",{top:m-b.helperProportions.height,left:0}).top-b.margins.top;if(r)d.position.left=b._convertPositionTo("relative",{top:0,left:j}).left-b.margins.left;if(s)d.position.left=b._convertPositionTo("relative",{top:0,left:l-b.helperProportions.width}).left-b.margins.left}if(!b.snapElements[i].snapping&&
(p||q||r||s||t))b.options.snap.snap&&b.options.snap.snap.call(b.element,a,c.extend(b._uiHash(),{snapItem:b.snapElements[i].item}));b.snapElements[i].snapping=p||q||r||s||t}else{b.snapElements[i].snapping&&b.options.snap.release&&b.options.snap.release.call(b.element,a,c.extend(b._uiHash(),{snapItem:b.snapElements[i].item}));b.snapElements[i].snapping=false}}}});c.ui.plugin.add("draggable","stack",{start:function(){var a=c(this).data("draggable").options;a=c.makeArray(c(a.stack)).sort(function(b,f){return(parseInt(c(b).css("zIndex"),
10)||0)-(parseInt(c(f).css("zIndex"),10)||0)});if(a.length){var d=parseInt(a[0].style.zIndex)||0;c(a).each(function(b){this.style.zIndex=d+b});this[0].style.zIndex=d+a.length}}});c.ui.plugin.add("draggable","zIndex",{start:function(a,d){var b=c(d.helper),f=c(this).data("draggable").options;if(b.css("zIndex"))f._zIndex=b.css("zIndex");b.css("zIndex",f.zIndex)},stop:function(a,d){var b=c(this).data("draggable").options;b._zIndex&&c(d.helper).css("zIndex",b._zIndex)}})})(jQuery);
